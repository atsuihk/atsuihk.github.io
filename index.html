<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Personal Website</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <!-- Header -->
  <header class="bg-blue-500 text-white py-6">
    <div class="container mx-auto px-4">
      <h1 class="text-3xl font-bold">atsui's Personal Website</h1>
      <p class="mt-2">A place with geospatial stuff and something that I think is fun.</p>
    </div>
  </header>

  <!-- About Section -->
  <section class="container mx-auto px-4 py-12">
    <h2 class="text-2xl font-semibold mb-4">About Me</h2>
    <p class="text-gray-700">
      I believe GIS can be applied in daily life, but not just a bloody abstract tech thing for people. So, I hope my demos here can provide you new insights and make you feel interested.
    </p>
  </section>

  <!-- Demos Section -->
  <section class="container mx-auto px-4 py-12 bg-white">
    <h2 class="text-2xl font-semibold mb-6">My Demos with ArcGIS apps</h2>
    <h4 class="text-1l">There are plenty social issues that can be explained with spatial data.</h2>
    <table id="demo-table" class="w-full table-auto border-collapse">
    <thead>
        <tr class="bg-gray-200">
        <th class="px-4 py-2 text-left">Picture</th>
        <th class="px-4 py-2 text-left">Demo Title</th>
        <th class="px-4 py-2 text-left">Description</th>
        </tr>
    </thead>
    <tbody id="demo-table-body">
        <!-- Table rows will be populated dynamically -->
    </tbody>
    </table>
</section>

<!-- Footer -->
<footer class="bg-gray-800 text-white py-6">
    <div class="container mx-auto px-4 text-center">
    <p>Â© 2025 Your Name. All rights reserved.</p>
    </div>
</footer>

<script>
    async function fetchAndPopulateTable() {
    try {
        // Replace with your GitHub-hosted Excel file URL
        const excelUrl = 'https://raw.githubusercontent.com/atsuihk/atsuihk.github.io/main/demos.xlsx';
        const response = await fetch(excelUrl);
        if (!response.ok) throw new Error('Failed to fetch Excel file');
        const arrayBuffer = await response.arrayBuffer();
        const workbook = XLSX.read(arrayBuffer, { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const data = XLSX.utils.sheet_to_json(sheet);

        const tableBody = document.getElementById('demo-table-body');
        tableBody.innerHTML = ''; // Clear any existing rows

        data.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = 'border-b';
        tr.innerHTML = `
            <td class="px-4 py-4">
            <img src="${row.Picture || 'https://via.placeholder.com/150'}" alt="${row['Demo Title'] || 'Demo'}" class="w-32 h-32 object-cover rounded">
            </td>
            <td class="px-4 py-4 font-medium">${row['Demo Title'] || 'Untitled Demo'}</td>
            <td class="px-4 py-4">${row.Description || 'No description available'}</td>
        `;
        tableBody.appendChild(tr);
        });
    } catch (error) {
        console.error('Error loading Excel file:', error);
        const tableBody = document.getElementById('demo-table-body');
        tableBody.innerHTML = '<tr><td colspan="3" class="px-4 py-4 text-center text-red-500">Failed to load demo data</td></tr>';
    }
    }

    // Load table data when the page loads
    window.onload = fetchAndPopulateTable;
</script>
</body>
</html>